# ุชุนูููุงุช ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช - ููุตุฉ Sabq Smart

## ุงููุดููุฉ ุงูุญุงููุฉ

ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชู ุฅูุดุงุคูุง ุจูุฌุงุญุ ููู ุงูู **endpoint ูุนุทู** ูู Neon. ูุฐุง ูููุน ุชุทุจูู ุงููุฎุทุทุงุช (migrations) ุชููุงุฆูุงู.

ุงูุฎุทุฃ ุงูุฐู ูุธูุฑ:
```
ERROR: The endpoint has been disabled. Enable it using Neon API and retry.
```

---

## ุงูุญู: ุชูุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุทุจูู ุงููุฎุทุทุงุช

### ุงูุฎุทูุฉ 1: ุชูุนูู Neon Database Endpoint

ูุฏูู ุฎูุงุฑุงู ูุชูุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

#### ุงูุฎูุงุฑ ุงูุฃูู: ูู ุฎูุงู Neon Console (ุงูุฃุณูู) โ

1. ุงูุชุญ [Neon Console](https://console.neon.tech)
2. ุงุฎุชุฑ ุงููุดุฑูุน ุงูุฎุงุต ุจู
3. ุงุฐูุจ ุฅูู: **Project โ Branches โ Main Branch โ Endpoints**
4. ุงุถุบุท ุนูู ุฒุฑ **"Enable"** ุฃู **"Start"** ุจุฌุงูุจ ุงูู endpoint
5. ุงูุชุธุฑ ุจุถุน ุซูุงูู ุญุชู ูุตุจุญ ุงูู endpoint ูู ุญุงูุฉ **"Active"**

#### ุงูุฎูุงุฑ ุงูุซุงูู: ูู ุฎูุงู Neon API

ุงุณุชุฎุฏู ูุฐุง ุงูุฃูุฑ (ุงุณุชุจุฏู ุงูููู ุงูููุงุณุจุฉ):
```bash
curl -X POST \
  'https://console.neon.tech/api/v2/projects/{project_id}/branches/{branch_id}/endpoints/{endpoint_id}/start' \
  -H 'Authorization: Bearer {your_api_key}'
```

---

### ุงูุฎุทูุฉ 2: ุชุทุจูู ุงููุฎุทุทุงุช (Migrations)

ุจุนุฏ ุชูุนูู ุงูู endpointุ ูุฏูู ุฎูุงุฑุงู:

#### ุงูุฎูุงุฑ ุงูุฃูู: ุชุทุจูู ุชููุงุฆู (ุงูุฃูุถู) โ

```bash
npm run db:push
```

ุฅุฐุง ุธูุฑุช ุชุญุฐูุฑุงุช ุจุดุฃู ููุฏุงู ุงูุจูุงูุงุชุ ุงุณุชุฎุฏู:
```bash
npm run db:push --force
```

#### ุงูุฎูุงุฑ ุงูุซุงูู: ุชุทุจูู ูุฏูู ูู ุฎูุงู SQL

ุฅุฐุง ูู ููุฌุญ ุงูุฃูุฑ ุฃุนูุงูุ ููููู ุชูููุฐ SQL ูุฏููุงู:

1. ุงูุชุญ [Neon SQL Editor](https://console.neon.tech) ูู ูุดุฑูุนู
2. ูููุฐ ูุญุชูู ุงูููู: **`complete_database_setup.sql`**
   - ูุฐุง ุงูููู ูุญุชูู ุนูู ุฌููุน ุงูุฌุฏุงูู ูุงูุนูุงูุงุช ุงููุงุฒูุฉ (339 ุณุทุฑ)
3. ุงูููู ูุชุถูู:
   - ุฌููุน ุฌุฏุงูู ุงููุธุงู (Users, Articles, Categories, ุฅูุฎ)
   - ุงูุนูุงูุงุช ูุงููููุฏ (Foreign Keys, Unique Constraints)
   - ุงูููุงุฑุณ (Indexes)
   - ุงูุชุญุณููุงุช ุงูุฅูุชุงุฌูุฉ

---

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ูุฌุงุญ ุงูุชุทุจูู

ุจุนุฏ ุชุทุจูู ุงููุฎุทุทุงุชุ ูููุฐ ูุฐุง ุงูุงุณุชุนูุงู ููุชุญูู:

```sql
-- ุงูุชุญูู ูู ุงููููุฏ ุงููุฑูุฏุฉ
SELECT constraint_name 
FROM information_schema.table_constraints 
WHERE table_name = 'short_links' 
  AND constraint_name = 'short_links_short_code_unique';

SELECT constraint_name 
FROM information_schema.table_constraints 
WHERE table_name = 'users' 
  AND constraint_name = 'users_apple_id_unique';

-- ุงูุชุญูู ูู ุญุฐู ุฌุฏูู trend_cache
SELECT table_name 
FROM information_schema.tables 
WHERE table_name = 'trend_cache';
-- ูุฌุจ ุฃู ูููู ุงููุงุชุฌ ูุงุฑุบุงู
```

---

### ุงูุฎุทูุฉ 4: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู

ุจุนุฏ ุงูุชุญูู ูู ูุฌุงุญ ุงููุฎุทุทุงุช:

```bash
# ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู
npm run dev
```

ุฃู ุจุจุณุงุทุฉ: ุฃุนุฏ ุชุดุบูู workflow "Start application" ูู Replit.

---

## ูููุงุช SQL ุงููุชุงุญุฉ

1. **`complete_database_setup.sql`** - ููู ุดุงูู ูุญุชูู ุนูู ุฌููุน ุงููุฎุทุทุงุช (339 ุณุทุฑ) โ
   - `migrations/0000_lazy_jocasta.sql` - ุงููุฎุทุท ุงูุฃุณุงุณู
   - `migrations/0001_production_constraints.sql` - ุงููููุฏ ุงูุฅุถุงููุฉ

2. **ุงููููุงุช ุงูุฃุฎุฑู ุงููุชุงุญุฉ:**
   - `publisher_tables.sql` - ุฌุฏุงูู ูุธุงู ุงููุงุดุฑูู
   - `test_keyword_search.sql` - ุงุฎุชุจุงุฑ ุงูุจุญุซ ุจุงููููุงุช ุงูููุชุงุญูุฉ
   - ููููุงุช SQL ุฃุฎุฑู ูุชุฎุตุตุฉ

---

## ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ ูู ุงููุธุงู

ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุชุถูู:

- **ุงููุณุชุฎุฏููู ูุงูุฃุฏูุงุฑ:** users, roles, permissions, role_permissions, user_roles
- **ุงููุญุชูู:** articles, categories, staff, media_library
- **ุงูุชูุงุนูุงุช:** comments, reactions, bookmarks, reading_history
- **ุงูุฐูุงุก ุงูุงุตุทูุงุนู:** ai_classifications, sentiment_scores, behavior_logs
- **ุงูุชุญูููุงุช:** analytics tables, click_tracking
- **ุงููุธุงู:** sessions, activity_logs, themes

**ุฅุฌูุงูู ุงูุฌุฏุงูู:** ุฃูุซุฑ ูู 50 ุฌุฏูู

---

## ููุงุญุธุงุช ูููุฉ

1. โ **ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุดุฃุฉ** - ุชู ุฅูุดุงุคูุง ุจูุฌุงุญ ูู Neon
2. โ๏ธ **ุงูู endpoint ูุนุทู** - ูุญุชุงุฌ ุชูุนูู ูุฏูู ูู Neon Console
3. ๐ **ุงููุฎุทุทุงุช ุฌุงูุฒุฉ** - ููู `complete_database_setup.sql` ูุญุชูู ุนูู ูู ุดูุก
4. ๐ **ุจุนุฏ ุงูุชูุนูู** - ูููุฐ `npm run db:push` ุฃู ุงูููู SQL ูุฏููุงู

---

## ุฏุนู ุฅุถุงูู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
- ุชุฃูุฏ ูู ุฃู DATABASE_URL ุตุญูุญ ูู environment variables
- ุชุญูู ูู ุฃู ุงูู endpoint ูู ุญุงูุฉ "Active" ูู Neon Console
- ุฑุงุฌุน logs ุงูุชุทุจูู ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู

---

**ุชู ุฅุนุฏุงุฏ ูุฐู ุงูุชุนูููุงุช ูู:** 20 ููููุจุฑ 2025
