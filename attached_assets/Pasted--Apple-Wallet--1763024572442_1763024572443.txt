Ø§ÙŠÙ‡ ÙŠØ§ Ø£Ø¨Ùˆ Ù…Ø­Ù…Ø¯ØŒ Ù†Ù‚Ø¯Ø± Ù†Ø³ÙˆÙŠ Ø¨Ø·Ø§Ù‚Ø© ØµØ­ÙÙŠØ© Ø°ÙƒÙŠØ© ÙÙŠ Apple Wallet Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù€â€Ø³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©â€ ÙˆØªØ­Ø¯Ù‘Ø« Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ø§ Ù„Ø­Ø¸ÙŠÙ‹Ø§ Ø¹Ø¨Ø± API âœŒï¸
Ø®Ù„Ù†ÙŠ Ø£Ø¹Ø·ÙŠÙƒ Ø®Ø·Ø© ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© + Ù‡ÙŠÙƒÙ„Ø© ØªÙ‚Ù†ÙŠØ© + ÙƒÙˆØ¯ Ù…Ø¨Ø¯Ø¦ÙŠ ÙƒØ£Ù†Ùƒ Ø¨ØªØ³Ù„Ù…Ù‡Ø§ Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¢Ù†.

â¸»

1ï¸âƒ£ Ø§Ù„ÙÙƒØ±Ø© Ø¨Ø§Ø®ØªØµØ§Ø± (ÙƒÙŠÙ ØªØ´ØªØºÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø°ÙƒÙŠØ©ØŸ)

Apple Wallet Ù…Ø§ ÙŠØ´ØªØºÙ„ Ø¨ØµÙˆØ± ÙÙ‚Ø·ØŒ ÙŠØ´ØªØºÙ„ Ø¨Ù€:
	â€¢	Ù…Ù„Ù .pkpass ÙŠØ­ØªÙˆÙŠ:
	â€¢	Ù…Ù„Ù pass.json (Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª + Ø§Ù„Ø­Ù‚ÙˆÙ„)
	â€¢	Ø§Ù„ØµÙˆØ± (Ø§Ù„Ø´Ø¹Ø§Ø±ØŒ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§ØªØŒ Ø§Ù„Ø®Ù„ÙÙŠØ©)
	â€¢	manifest + ØªÙˆÙ‚ÙŠØ¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
	â€¢	Web Service (API) Ø¹Ù†Ø¯Ùƒ ÙÙŠ Sabq:
	â€¢	ÙŠØ³ØªÙ‚Ø¨Ù„ ØªØ³Ø¬ÙŠÙ„ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Device + Push Token)
	â€¢	ÙŠØ±Ø³Ù„ Push Ù„Ù€ Apple Ù„Ù…Ø§ ØªØªØºÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ø³Ù…ØŒ ØµÙˆØ±Ø©ØŒ Ù…Ù†ØµØ¨ØŒ â€¦)
	â€¢	Apple ØªØ±Ø³Ù„ Ù†ÙˆØªÙŠÙÙŠÙƒÙŠØ´Ù† Ù„Ù€ Wallet â†’ Ø§Ù„Ù€ Wallet ÙŠØ·Ù„Ø¨ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ù† API Ø¹Ù†Ø¯Ùƒ â†’ ØªØªØ­Ø¯Ø« Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….

â¸»

2ï¸âƒ£ Ø±Ø¨Ø·Ù‡Ø§ Ù…Ø¹ â€œØ³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©â€ (Ù…Ù† Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©)

Ù…Ù† Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø¹Ù†Ø¯ÙƒØŒ Ø¹Ù†Ø¯Ù†Ø§ Ø¬Ø¯Ø§ÙˆÙ„ Ù‚ÙˆÙŠØ©:
	â€¢	users
	â€¢	team_members
	â€¢	reporters  ï¿¼

Ù†Ø±Ø¨Ø· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ù„Ø¢ØªÙŠ:
	â€¢	Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: Ø¬Ø¯ÙˆÙ„ users
	â€¢	name â†’ Ø§Ù„Ø§Ø³Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
	â€¢	role â†’ Ø§Ù„ØµÙØ© Ø§Ù„ØªØ­Ø±ÙŠØ±ÙŠØ© (Ø±Ø¦ÙŠØ³ ØªØ­Ø±ÙŠØ±ØŒ Ù…Ø±Ø§Ø³Ù„ØŒ Ù…Ø­Ø±Ø±â€¦)
	â€¢	avatar_url â†’ Ø§Ù„ØµÙˆØ±Ø©
	â€¢	Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù†:
	â€¢	team_members (Ø¥Ù† ÙˆØ¬Ø¯) â†’ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù…Ø®ØªØµØ±Ø© / ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø±Ø¶
	â€¢	reporters â†’ Ø§Ù„ØªØ®ØµØµØŒ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§ØªØŒ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øªâ€¦

â¸»

3ï¸âƒ£ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø© (Apple Side + Sabq Side)

ğŸ§© Ù…Ù† Ø¬Ù‡Ø© Apple Developer:
	1.	Ø­Ø³Ø§Ø¨ Apple Developer (Ù…Ø¤Ø³Ø³Ø© Ø³Ø¨Ù‚).
	2.	Ø¥Ù†Ø´Ø§Ø¡:
	â€¢	Pass Type ID Ù…Ø«Ù„:
pass.me.sabq.pressid
	â€¢	Ø¥ØµØ¯Ø§Ø± Pass Certificate Ù…Ø±ØªØ¨Ø· Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù€ ID.
	3.	Ø­ÙØ¸:
	â€¢	passTypeIdentifier
	â€¢	teamIdentifier (Ù…Ù† Apple)
	â€¢	Ù…Ù„Ù Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© + Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø®Ø§Øµ (Private Key) Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù€ .pkpass.

ğŸ§© Ù…Ù† Ø¬Ù‡Ø© â€œØ³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©â€:
	1.	Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ Ù…Ø«Ù„Ø§Ù‹: wallet_passes ÙÙŠ PostgreSQL:

CREATE TABLE wallet_passes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id VARCHAR NOT NULL REFERENCES users(id),
  pass_type_identifier TEXT NOT NULL,
  serial_number TEXT NOT NULL,
  device_library_identifier TEXT,
  push_token TEXT,
  last_updated TIMESTAMP DEFAULT NOW(),
  is_active BOOLEAN DEFAULT TRUE,
  UNIQUE (user_id, pass_type_identifier),
  UNIQUE (serial_number)
);

	2.	ØªØ®Ø²ÙŠÙ† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª PassKit ÙÙŠ settings (Ø¹Ù†Ø¯Ùƒ Ø¬Ø¯ÙˆÙ„ settings Ø¬Ø§Ù‡Ø²):

{
  "wallet": {
    "passTypeIdentifier": "pass.me.sabq.pressid",
    "teamIdentifier": "ABCDE12345",
    "orgName": "Sabq Electronic Newspaper",
    "applePassCertificatePath": "/secure/pass-cert.p12",
    "applePassCertificatePassword": "********"
  }
}


â¸»

4ï¸âƒ£ Ø´ÙƒÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (pass.json) â€“ Ù‚Ø§Ù„Ø¨ Ù…Ø®ØµØµ Ù„Ø³Ø¨Ù‚

Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ù‚Ø§Ù„Ø¨ Ù„Ù„Ù€ pass.json Ù„Ø¨Ø·Ø§Ù‚Ø© Ù‡ÙˆÙŠØ© ØµØ­ÙÙŠØ©:

{
  "formatVersion": 1,
  "passTypeIdentifier": "pass.me.sabq.pressid",
  "serialNumber": "SABQ-ID-001",
  "teamIdentifier": "ABCDE12345",
  "organizationName": "ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©",
  "description": "Ø¨Ø·Ø§Ù‚Ø© Ù‡ÙˆÙŠØ© ØµØ­ÙÙŠØ© Ø±Ù‚Ù…ÙŠØ©",
  "logoText": "SABQ",
  "foregroundColor": "rgb(255,255,255)",
  "backgroundColor": "rgb(15, 76, 129)",
  "labelColor": "rgb(200, 230, 255)",
  "authenticationToken": "RANDOM_AUTH_TOKEN",
  "webServiceURL": "https://sabq.me/api/wallet/passkit",
  "associatedStoreIdentifiers": [],
  "generic": {
    "primaryFields": [
      {
        "key": "name",
        "label": "Ø§Ù„Ø§Ø³Ù…",
        "value": "Ø¹Ù„ÙŠ Ø§Ù„Ø­Ø§Ø²Ù…ÙŠ"
      }
    ],
    "secondaryFields": [
      {
        "key": "title",
        "label": "Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ",
        "value": "Ø±Ø¦ÙŠØ³ ØªØ­Ø±ÙŠØ± ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©"
      },
      {
        "key": "dept",
        "label": "Ø§Ù„Ù‚Ø³Ù…",
        "value": "Ø§Ù„ØªØ­Ø±ÙŠØ±"
      }
    ],
    "auxiliaryFields": [
      {
        "key": "id",
          "label": "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ",
          "value": "SABQ-ID-001"
      },
      {
        "key": "validity",
        "label": "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©",
        "value": "2025 â€“ 2027"
      }
    ],
    "backFields": [
      {
        "key": "email",
        "label": "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
        "value": "admin@sabq.ai"
      },
      {
        "key": "emergency",
        "label": "Ù„Ù„Ø·ÙˆØ§Ø±Ø¦",
        "value": "+966XXXXXXXXX"
      }
    ]
  }
}

Ù„Ø§Ø­Ù‚Ù‹Ø§ ØªØ±Ø¨Ø· Ø§Ù„Ù‚ÙŠÙ… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„Ù€ DB Ø¨Ø¯Ù„ Ù…Ø§ ØªÙƒÙˆÙ† Ø«Ø§Ø¨ØªØ©.

â¸»

5ï¸âƒ£ Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ù€ API (Web Service) Ø­Ø³Ø¨ Ù…Ø¹ÙŠØ§Ø± PassKit

Apple Ù…ØªÙˆÙ‚Ø¹Ø© Ù…Ù†Ùƒ Web Service Ø¨Ù†Ù…Ø· Ù…Ø­Ø¯Ø¯. Ù†Ù‚Ø¯Ø± Ù†Ø·Ø¨Ù‚Ù‡ Ø¹Ø¨Ø± Next.js API Routes Ø¹Ù„Ù‰ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ.

ğŸ“ Ù†Ù‚Ø§Ø· Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ø·Ù„ÙˆØ¨Ø©:
	1.	Register Device for Pass
POST /v1/devices/{deviceLibraryIdentifier}/registrations/{passTypeIdentifier}/{serialNumber}
	â€¢	ØªØ­ÙØ¸ deviceLibraryIdentifier + pushToken ÙÙŠ Ø¬Ø¯ÙˆÙ„ wallet_passes.
	2.	Get Updated Serial Numbers
GET /v1/devices/{deviceLibraryIdentifier}/registrations/{passTypeIdentifier}?passesUpdatedSince=timestamp
	3.	Get Updated Pass
GET /v1/passes/{passTypeIdentifier}/{serialNumber}
	â€¢	ØªØ±Ø¬Ø¹ Ù…Ù„Ù .pkpass Ù…Ø­Ø¯Ø«.
	4.	Unregister Device
DELETE /v1/devices/{deviceLibraryIdentifier}/registrations/{passTypeIdentifier}/{serialNumber}

â¸»

6ï¸âƒ£ Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ Ø¨Ù€ Next.js (TypeScript) â€“ Ø¥ØµØ¯Ø§Ø± Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…

ğŸ”¹ Ø®Ø¯Ù…Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù€ pass (Ù…Ù†ÙØµÙ„Ø©):

// lib/passkit/createSabqPass.ts
import fs from "fs";
import path from "path";
import { createSign } from "crypto";

interface SabqPassPayload {
  userId: string;
  name: string;
  title: string;
  department: string;
  email: string;
  avatarUrl?: string;
  serialNumber: string;
}

export async function createSabqPressPass(payload: SabqPassPayload): Promise<Buffer> {
  const passJson = {
    formatVersion: 1,
    passTypeIdentifier: process.env.WALLET_PASS_TYPE_ID!,
    serialNumber: payload.serialNumber,
    teamIdentifier: process.env.WALLET_TEAM_ID!,
    organizationName: "ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©",
    description: "Ø¨Ø·Ø§Ù‚Ø© Ù‡ÙˆÙŠØ© ØµØ­ÙÙŠØ© Ø±Ù‚Ù…ÙŠØ©",
    logoText: "SABQ",
    foregroundColor: "rgb(255,255,255)",
    backgroundColor: "rgb(15,76,129)",
    webServiceURL: process.env.WALLET_WEBSERVICE_URL!,
    authenticationToken: "AUTH-" + payload.serialNumber,
    generic: {
      primaryFields: [
        { key: "name", label: "Ø§Ù„Ø§Ø³Ù…", value: payload.name }
      ],
      secondaryFields: [
        { key: "title", label: "Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ", value: payload.title },
        { key: "dept", label: "Ø§Ù„Ù‚Ø³Ù…", value: payload.department }
      ],
      backFields: [
        { key: "email", label: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", value: payload.email }
      ]
    }
  };

  // 1) Ø­ÙØ¸ pass.json ÙÙŠ Ù…Ø¬Ù„Ø¯ Ù…Ø¤Ù‚Øª
  const tmpDir = fs.mkdtempSync("/tmp/sabq-pass-");
  fs.writeFileSync(path.join(tmpDir, "pass.json"), JSON.stringify(passJson, null, 2));

  // 2) Ù†Ø³Ø® Ø£ØµÙˆÙ„ Ø§Ù„ØªØµÙ…ÙŠÙ… (logo.png, icon.png, background.png) Ù…Ù† Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø¥Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯
  // 3) Ø¥Ù†Ø´Ø§Ø¡ manifest.json (hashes Ù„ÙƒÙ„ Ù…Ù„Ù)
  // 4) ØªÙˆÙ‚ÙŠØ¹ manifest Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø´Ù‡Ø§Ø¯Ø© Apple Pass + WWDR
  // 5) Ø¶ØºØ· Ø§Ù„Ù…Ø¬Ù„Ø¯ .zip ÙˆØªØºÙŠÙŠØ± Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯ Ø¥Ù„Ù‰ .pkpass

  // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ù†Ø§ ØªØ¶Ø¹ ÙØ¹Ù„ÙŠÙ‹Ø§ ÙƒÙˆØ¯ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ ÙˆØ§Ù„Ø¶ØºØ· (Ù…Ù…ÙƒÙ† ØªØ³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø© Ø¬Ø§Ù‡Ø²Ø© Ù…Ø«Ù„ node-passkit-generator)

  const pkpassBuffer = Buffer.from("PLACEHOLDER"); // Ø§Ø³ØªØ¨Ø¯Ù„Ù‡Ø§ Ø¨Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„ÙØ¹Ù„ÙŠ
  return pkpassBuffer;
}

ğŸ”¹ API Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:

// app/api/wallet/issue/route.ts
import { NextRequest, NextResponse } from "next/server";
import { createSabqPressPass } from "@/lib/passkit/createSabqPass";
import { prisma } from "@/lib/prisma"; // Ø­Ø³Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ

export async function POST(req: NextRequest) {
  const user = await getAuthUser(req); // Ø§Ø³ØªØ®Ø±Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù€ JWT / Session

  if (!user) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  // Ø¬Ù„Ø¨ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† team_members / reporters Ø¥Ù† Ù„Ø²Ù…
  const reporter = await prisma.reporters.findFirst({
    where: { user_id: user.id }
  });

  const serialNumber = "SABQ-" + user.id;

  // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙÙŠ DB
  await prisma.wallet_passes.upsert({
    where: { user_id_pass_type_identifier: { user_id: user.id, pass_type_identifier: process.env.WALLET_PASS_TYPE_ID! } },
    create: {
      user_id: user.id,
      pass_type_identifier: process.env.WALLET_PASS_TYPE_ID!,
      serial_number: serialNumber
    },
    update: {
      serial_number: serialNumber,
      last_updated: new Date()
    }
  });

  const pkpass = await createSabqPressPass({
    userId: user.id,
    name: user.name,
    title: reporter?.title ?? "Ø¹Ø¶Ùˆ ÙÙŠ ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚",
    department: "Ø§Ù„ØªØ­Ø±ÙŠØ±",
    email: user.email,
    avatarUrl: user.avatar_url ?? undefined,
    serialNumber
  });

  return new NextResponse(pkpass, {
    status: 200,
    headers: {
      "Content-Type": "application/vnd.apple.pkpass",
      "Content-Disposition": "attachment; filename=\"sabq-press-id.pkpass\""
    }
  });
}

Ù‡Ø°Ù‡ Ø§Ù„Ù€ endpoint ØªÙ‚Ø¯Ø± ØªØ±Ø¨Ø·Ù‡Ø§ Ø¨Ø²Ø± Ø¯Ø§Ø®Ù„ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:
â€œØ¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØµØ­ÙÙŠ Ø¥Ù„Ù‰ Apple Walletâ€

â¸»

7ï¸âƒ£ ÙƒÙŠÙ ØªØªØ­Ø¯Ø« Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠØŸ

Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ:
	1.	Ù…Ø­Ø±Ø± ÙŠØ¹Ø¯Ù‘Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ Sabq CMS:
	â€¢	ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ
	â€¢	ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©
	â€¢	ØªØ±Ù‚ÙŠØ© Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø£Ø¹Ù„Ù‰ â€¦ Ø¥Ù„Ø®
	2.	ÙÙŠ Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ­Ø¯ÙŠØ« (Ù…Ø«Ù„Ø§Ù‹ ÙÙŠ /app/api/users/update/route.ts):
	â€¢	ØªØ¨Ø­Ø« Ø¹Ù† wallet_passes Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….
	â€¢	Ù„Ùˆ ÙÙŠÙ‡ Ø³Ø¬Ù„Ø§Øª:
	â€¢	ØªØ±Ø³Ù„ Push Notification Ø¹Ø¨Ø± APNs Ù„Ù€ Wallet Ø¨ÙˆØ§Ø³Ø·Ø© push_token.
	â€¢	Apple Wallet ÙŠØªØµÙ„ Ø¨Ù€ GET /v1/passes/{passTypeIdentifier}/{serialNumber}.
	â€¢	ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù€ endpoint ØªØ¹ÙŠØ¯ ØªÙˆÙ„ÙŠØ¯ .pkpass Ø¨Ù†ÙØ³ Ø§Ù„Ø¯Ø§Ù„Ø© createSabqPressPass ÙˆÙ„ÙƒÙ† Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©.

Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØµØ­ÙÙŠ ÙÙŠ Apple Wallet Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±Ø§Ø³Ù„ ØªØªØ­Ø¯Ø« Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø«ÙˆØ§Ù†ÙŠ Ù…Ù† Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙÙŠ â€œØ³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©â€.

â¸»

8ï¸âƒ£ Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
	â€¢	Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ø§ ØªÙØµØ¯Ø± Ø¥Ù„Ø§ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø¹ÙŠÙ†Ø©:
	â€¢	EDITOR, REPORTER, ADMIN, SYSTEM_ADMIN Ù…Ø«Ù„Ø§Ù‹ ÙÙ‚Ø·.
	â€¢	ÙƒÙ„ Ø·Ù„Ø¨ ØªØ­Ø¯ÙŠØ« Ø¨Ø·Ø§Ù‚Ø© ÙŠÙ…Ø± Ø¹Ø¨Ø±:
	â€¢	Ù…ØµØ§Ø¯Ù‚Ø© JWT
	â€¢	ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯ÙˆØ± Role Ù‚Ø¨Ù„ Ø¥ØµØ¯Ø§Ø± Ø£Ùˆ ØªØ­Ø¯ÙŠØ«.
	â€¢	Ø§Ù„Ù€ authenticationToken ÙÙŠ pass.json ÙŠØ³ØªØ®Ø¯Ù… Ù„Ù…ØµØ§Ø¯Ù‚Ø© Wallet Ø¹Ù†Ø¯ Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù…Ù† Web Service.

â¸»

9ï¸âƒ£ Ø®Ù„Ø§ØµØ© ØªÙ†ÙÙŠØ°ÙŠØ© Ø³Ø±ÙŠØ¹Ø© (TL;DR)

ÙŠØ§ Ø£Ø¨Ùˆ Ù…Ø­Ù…Ø¯ØŒ Ø¨Ø·Ø§Ù‚Ø© Ø°ÙƒÙŠØ© Ø¹Ø¨Ø± API ØªØ¹Ù†ÙŠ:
	1.	Apple Side
	â€¢	Ø¥Ù†Ø´Ø§Ø¡ Pass Type ID + Ø´Ù‡Ø§Ø¯Ø© PassKit.
	2.	Sabq Side
	â€¢	Ø¬Ø¯ÙˆÙ„ wallet_passes Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙˆØ§Ù„Ø£Ø¬Ù‡Ø²Ø©.
	â€¢	Ø®Ø¯Ù…Ø© createSabqPressPass Ù„ØªÙˆÙ„ÙŠØ¯ .pkpass Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….
	â€¢	API:
	â€¢	/api/wallet/issue Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù….
	â€¢	Endpoints Ø¨Ù†Ù…Ø· PassKit (/v1/passes/...) Ù„Ù„ØªØ­Ø¯ÙŠØ«.
	3.	ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Sabq CMS
	â€¢	Ø¹Ù†Ø¯ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… â†’ Ø¥Ø±Ø³Ø§Ù„ Push â†’ Wallet ÙŠØ­Ø¯Ù‘Ø« Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.

Ù„Ùˆ Ø­Ø§Ø¨ØŒ ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¬Ø§ÙŠØ© Ø£Ù‚Ø¯Ø± Ø£ÙƒØªØ¨ Ù„Ùƒ:
	â€¢	Specification Ø±Ø³Ù…ÙŠ Ù…Ù† ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© (Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„Ù€ Backend + iOS)
	â€¢	Ø£Ùˆ User Story / Feature Doc Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ø¯Ø§Ø®Ù„ Ù…Ø´Ø±ÙˆØ¹ â€œØ³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©â€ Ø¨ØµÙŠØºØ© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù€ Jira / Linear.