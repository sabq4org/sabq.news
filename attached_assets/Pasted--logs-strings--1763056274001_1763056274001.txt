## ğŸ¯ **Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ - Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø± ØªÙ…Ø§Ù…Ø§Ù‹!**

Ø§Ù„Ù€ logs ØªÙØ¸Ù‡Ø± Ø£Ù† Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª **Ø¨Ø§ØªØª strings** Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ØŒ Ù„ÙƒÙ† Ø§Ù„Ø®Ø·Ø£ ÙŠØ¨Ù‚Ù‰! Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© **Ù„ÙŠØ³Øª ÙÙŠ Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª** Ø¨Ù„ ÙÙŠ **ÙƒÙŠÙÙŠØ© ØªÙ…Ø±ÙŠØ±Ù‡Ø§ Ù„Ù€ PKPass**.

### **Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ**

Ù…ÙƒØªØ¨Ø© `passkit-generator` v3.x **Ù…Ø§ ØªØªÙ‚Ø¨Ù„** Ø£Ù† ØªÙÙ…Ø±Ù‘Ø± Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ù…Ø«Ù„ `serialNumber`, `description`, `organizationName`) **Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ù€ object** Ù…Ø¹ `certificates` Ùˆ`model`. Ù‡Ø°Ù‡ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØªÙ‡Ø§ **Ø¨Ø¹Ø¯** Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù€ PKPass.

**Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙÙŠ Ø§Ù„Ù€ logs:**
```javascript
_original: {
  serialNumber: 'SABQ-LOYAL-ADMIN-SA',
  description: 'Sabq Smart Loyalty Card',
  organizationName: 'Ø³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©',
  // ... Ù‡Ø°Ù‡ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©ØŒ Ù„ÙŠØ³Øª Ø´Ù‡Ø§Ø¯Ø§Øª!
}
```

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©**: Ø£Ù†Øª ØªÙ…Ø±Ø± ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ ÙƒØ§Ø¦Ù† ÙˆØ§Ø­Ø¯:
```typescript
// âŒ Ø®Ø§Ø·Ø¦ ÙÙŠ v3.x
PKPass.from({
  model: this.model,
  certificates: { ... },
  serialNumber: '...',
  description: '...',
  // ... ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù‡Ù†Ø§
})
```

---

## âœ… **Ø§Ù„Ø­Ù„ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù€ passkit-generator v3.x**

### **ÙÙŠ `LoyaltyPassBuilder.ts` Ø£Ùˆ `PressPassBuilder.ts`:**

```typescript
async generatePass(userData: any) {
  try {
    // 1. Ø¬Ù‡Ù‘Ø² Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª (strings ÙÙ‚Ø·)
    const certs = this.passKitService.loadCertificates();
    
    // ğŸ”¥ ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
    const certificates = {
      wwdr: String(certs.wwdr),
      signerCert: String(certs.signerCert),
      signerKey: String(certs.signerKey),
      signerKeyPassphrase: certs.signerKeyPassphrase
    };

    console.log('âœ… [PassBuilder] Final certificates:', {
      wwdrType: typeof certificates.wwdr,
      allKeys: Object.keys(certificates)
    });

    // 2. Ø£Ù†Ø´Ø¦ PKPass Ø¨Ù€ model Ùˆ certificates ÙÙ‚Ø·
    const pass = await PKPass.from({
      model: this.model,
      certificates: certificates
    });

    // 3. Ø£Ø¶Ù Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© **Ø¨Ø¹Ø¯** Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
    await pass.headerFields.add({
      label: 'Ø§Ù„Ø§Ø³Ù…',
      value: userData.fullName || userData.name,
      key: 'name'
    });

    await pass.primaryFields.add({
      label: 'Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©',
      value: userData.membershipTier || 'VIP',
      key: 'tier'
    });

    // 4. Ø­Ù‚ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠØ©
    await pass.secondaryFields.add({
      label: 'Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©',
      value: new Date(userData.expiryDate).toLocaleDateString('ar-SA'),
      key: 'expiry'
    });

    // 5. Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯
    await pass.barcodes.add({
      format: 'PKBarcodeFormatQR',
      message: userData.qrData || userData.id,
      messageEncoding: 'iso-8859-1'
    });

    // 6. Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†
    pass.setBackgroundColor('rgb(212, 175, 55)');
    pass.setForegroundColor('rgb(255, 255, 255)');

    return pass;
  } catch (error) {
    console.error('âŒ [PassBuilder] Generation failed:', error);
    throw error;
  }
}
```

---

## ğŸ”§ **Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… passkit-generator v2.x**

Ø¥Ø°Ø§ Ù…Ø§ Ø²Ù„Øª ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ API Ø§Ù„Ù‚Ø¯ÙŠÙ…ØŒ **ØºÙŠÙ‘Ø± Ø§Ù„Ù€ import** Ù„ÙƒÙ† **ØºÙŠØ± Ù…Ø³ØªØ­Ø³Ù†**:

```typescript
// âŒ ØºÙŠØ± Ø¢Ù…Ù† - Ø§Ø³ØªØ®Ø¯Ù… v3.x API Ø£Ø¹Ù„Ø§Ù‡
import { PKPass } from 'passkit-generator@2.x';
```

---

## ğŸš€ **Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙÙˆØ±ÙŠØ©**

1. **Ø¹Ø¯Ù‘Ù„ Ø§Ù„ÙƒÙˆØ¯** ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ù…Ø«Ø§Ù„ Ø£Ø¹Ù„Ø§Ù‡
2. **Ø£Ø²Ù„ Ø£ÙŠ Ø­Ù‚ÙˆÙ„ Ø¨Ø·Ø§Ù‚Ø©** Ù…Ù† Ø¯Ø§Ø®Ù„ `PKPass.from()`
3. **Ø£Ø¹Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡**:
   ```bash
   npm run build
   ```
4. **Ø£Ø¹Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„** (Restart machine)
5. **Ø§Ø®ØªØ¨Ø±** - ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„!

---

## ğŸ“‹ **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø±**

ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ÙƒØªØ¨Ø© ÙÙŠ `package.json`:
```json
{
  "dependencies": {
    "passkit-generator": "^3.0.0" // Ø£Ùˆ Ø£Ø­Ø¯Ø«
  }
}
```

Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ù†Ø¯Ùƒ v2.xØŒ Ø§Ù„Ù€ API Ù…Ø®ØªÙ„Ù ØªÙ…Ø§Ù…Ø§Ù‹. **Ø­Ø¯Ù‘Ø«**:
```bash
npm install passkit-generator@latest
```

---

## âœ… **Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØµØ­ÙŠØ­**

ÙŠØ¬Ø¨ Ø£Ù† ØªØ±Ù‰ ÙÙŠ Ø§Ù„Ù€ logs:
```
âœ… [PassBuilder] Final certificates: { wwdrType: 'string', allKeys: ['wwdr', 'signerCert', 'signerKey'] }
âœ… PKPass created successfully!
âœ… Pass fields added successfully!
```

**Ù„Ø§ Ù…Ø²ÙŠØ¯ Ù…Ù† `"wwdr" is required`! ğŸ‰**